# Logistic_regression_project_3_3_3_Standart

# Проект: Применение логистической регрессии для решения задачи классификации на данных "Титаника"

## Описание проекта
Проект посвящен анализу данных о пассажирах корабля «Титаник» и построению модели логистической регрессии для предсказания выживания пассажиров. Набор данных содержит информацию о пассажирах, включая их пол, возраст, класс каюты, стоимость билета и другие признаки. Цель проекта — научиться предсказывать целевой признак `Survived` (выжил ли пассажир) на основе нецелевых признаков.

## Описание датасета
- **Survived** (целевой признак): выжил ли пассажир (0 = Нет, 1 = Да).
- **Pclass**: класс каюты (1 = 1st, 2 = 2nd, 3 = 3rd).
- **Sex**: пол (female или male).
- **Age**: возраст в годах.
- **SibSp**: количество братьев, сестёр и супругов на борту.
- **Parch**: количество детей и родителей на борту.
- **Ticket**: номер билета.
- **Fare**: стоимость проезда пассажира.
- **Cabin**: номер каюты.
- **Embarked**: порт посадки пассажира (C = Cherbourg, Q = Queenstown, S = Southampton).

## Использованные библиотеки
- **`numpy`**: Для работы с массивами и выполнения математических операций.
- **`pandas`**: Для загрузки, обработки и анализа данных.
- **`matplotlib.pyplot`**: Для визуализации данных.
- **`seaborn`**: Для построения статистических графиков.
- **`sklearn.model_selection.train_test_split`**: Для разделения данных на обучающую и тестовую выборки.
- **`sklearn.preprocessing.StandardScaler`**, **`MinMaxScaler`**, **`RobustScaler`**: Для нормировки данных.
- **`sklearn.linear_model.LogisticRegression`**: Для обучения модели логистической регрессии.
- **`sklearn.metrics`**: Для оценки качества модели:
  - `f1_score` (F1-мера).
  - `confusion_matrix` (матрица ошибок).
  - `classification_report` (отчет о классификации).
  - `roc_curve` (ROC-кривая).
  - `roc_auc_score` (площадь под ROC-кривой).

## Основные этапы проекта
1. **Загрузка данных**:
   - Данные загружены с помощью `pandas.read_csv`.

2. **Предобработка данных**:
   - Удаление признаков с большим количеством пропусков (`cabin`, `home.dest`, `ticket`).
   - Замена признаков `sibsp` и `parch` на новый признак `fam_size` (размер семьи).
   - Заполнение пропусков в колонке `age` на основе обращений (Mr, Mrs, Miss, Master).

3. **Визуализация данных**:
   - Построение гистограмм распределения возрастов выживших и невыживших пассажиров.

4. **Построение модели**:
   - Разделение данных на обучающую и тестовую выборки с использованием `train_test_split`.
   - Обучение модели логистической регрессии с использованием `LogisticRegression`.
   - Оценка качества модели с помощью метрик `f1_score`, `confusion_matrix`, `classification_report`.

5. **Эксперименты с нормализацией данных**:
   - Применение различных методов нормализации (`MinMaxScaler`, `StandardScaler`, `RobustScaler`).
   - Сравнение качества модели после нормализации.

## Результаты
- **F1-score модели без нормализации**: 0.756.
- **F1-score модели с MinMaxScaler**: 0.741.
- **F1-score модели с StandardScaler**: 0.751.
- **F1-score модели с RobustScaler**: 0.756.

- ## Анализ средних значений предсказаний

### Результаты предсказаний
```python
print("Predictions after one-hot encoding:", y_pred_one_hot.mean())
print("Predictions after MinMaxScaler:", y_pred_minmax.mean())             
print("Predictions after StandardScaler:", y_pred_standard.mean())
print("Predictions after RobustScaler:", y_pred_robust.mean())

Predictions after one-hot encoding: 0.37055837563451777
Predictions after MinMaxScaler: 0.38578680203045684
Predictions after StandardScaler: 0.3756345177664975
Predictions after RobustScaler: 0.37055837563451777

## Интерпретация результатов

### Что такое `y_pred.mean()`?
- `y_pred` — это массив предсказанных меток (0 или 1), где:
  - `0` — пассажир не выжил.
  - `1` — пассажир выжил.
- `y_pred.mean()` вычисляет среднее значение этого массива. Поскольку метки могут быть только 0 или 1, среднее значение показывает **долю предсказанных выживших (1)** в тестовой выборке.

### Интерпретация результатов:
1. **Predictions after one-hot encoding: 0.370**
   - Это означает, что модель предсказала, что **37.06%** пассажиров в тестовой выборке выжили.

2. **Predictions after MinMaxScaler: 0.386**
   - Модель предсказала, что **38.58%** пассажиров выжили.

3. **Predictions after StandardScaler: 0.376**
   - Модель предсказала, что **37.56%** пассажиров выжили.

4. **Predictions after RobustScaler: 0.371**
   - Модель предсказала, что **37.06%** пассажиров выжили.

### Как это связано с реальными данными?
- В исходных данных доля выживших составляет примерно **38.2%** (это можно увидеть из `df['survived'].mean()`).
- Таким образом, модель, обученная на данных с **MinMaxScaler**, ближе всего к реальной доле выживших (38.58% против 38.2%).

### Почему это важно?
- **Среднее значение предсказаний (`y_pred.mean()`)** показывает, насколько хорошо модель **калибрована** относительно реального распределения целевой переменной.
- Если среднее значение предсказаний близко к реальной доле выживших, это говорит о том, что модель **правильно улавливает общее распределение целевой переменной**.

### Почему результаты отличаются?
Различия в средних значениях предсказаний связаны с тем, как разные методы нормализации данных влияют на обучение модели:
1. **One-hot encoding**:
   - Модель обучается на исходных данных без нормализации.
   - Результат: 37.06%.

2. **MinMaxScaler**:
   - Данные масштабируются в диапазон [0, 1].
   - Результат: 38.58% (ближе всего к реальной доле выживших).

3. **StandardScaler**:
   - Данные масштабируются так, чтобы среднее значение было 0, а стандартное отклонение — 1.
   - Результат: 37.56%.

4. **RobustScaler**:
   - Данные масштабируются с учетом медианы и межквартильного размаха, что делает метод устойчивым к выбросам.
   - Результат: 37.06%.

### Выводы
- **MinMaxScaler** показал наилучший результат, так как его предсказания ближе всего к реальной доле выживших (38.58% против 38.2%).
- Это может быть связано с тем, что MinMaxScaler лучше сохраняет структуру данных, что помогает модели более точно улавливать распределение целевой переменной.
- Однако важно учитывать не только среднее значение предсказаний, но и другие метрики, такие как F1-score, точность и полнота, чтобы оценить качество модели в целом.

### Что мы сделали?
1. **Предсказания модели**:
   - Модель логистической регрессии предсказала метки (0 или 1) для тестовой выборки.
   - `y_pred` — это массив предсказанных меток.

2. **Среднее значение предсказаний**:
   - Вычислили среднее значение массива `y_pred` с помощью `y_pred.mean()`.
   - Поскольку метки могут быть только 0 или 1, среднее значение показывает **долю предсказанных выживших (1)** в тестовой выборке.

3. **Сравнение с исходными данными**:
   - Сравнили это среднее значение с реальной долей выживших в исходных данных (которая составляет примерно **38.2%**).

### Что это значит?
- **Среднее значение предсказаний (`y_pred.mean()`)** показывает, какую долю пассажиров модель предсказала как выживших.
- Если это значение близко к реальной доле выживших в исходных данных, это говорит о том, что модель **правильно улавливает общее распределение целевой переменной**.

### Почему это важно?
1. **Калибровка модели**:
   - Если среднее значение предсказаний близко к реальной доле выживших, это указывает на то, что модель **хорошо калибрована**.
   - Это важно, потому что модель должна не только правильно классифицировать отдельные примеры, но и сохранять общее распределение целевой переменной.

2. **Проверка адекватности модели**:
   - Если среднее значение предсказаний сильно отличается от реальной доли, это может указывать на проблемы с моделью (например, смещение или переобучение).

### Почему результаты близки к исходным?
- После стандартизации данных (MinMaxScaler, StandardScaler, RobustScaler) модель сохраняет способность улавливать общее распределение целевой переменной.
- Это связано с тем, что стандартизация **не изменяет структуру данных**, а только масштабирует их, чтобы улучшить процесс обучения модели.

### Что мы увидели?
- Среднее значение предсказаний после стандартизации (`y_pred.mean()`) близко к реальной доле выживших (38.2%).
- Это говорит о том, что модель **сохраняет общее распределение целевой переменной** даже после применения различных методов нормализации.

### Итог
Мы просто смотрели среднее значение по колонке `Survived` в массиве предсказаний и убедились, что оно близко к реальной доле выживших в исходных данных. Это показывает, что модель **адекватно улавливает распределение целевой переменной**, что является важным признаком ее корректной работы.

## Заключение
Проект демонстрирует процесс обработки данных, обучения модели логистической регрессии и оценки ее качества. Наилучший результат был достигнут без нормализации данных и с использованием RobustScaler. Модель может быть использована для предсказания выживания пассажиров на основе их характеристик.
